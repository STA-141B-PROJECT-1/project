---
title: "Question1"
output: html_document
---


```{r}
library(tidyverse)
library(httr)
library(jsonlite)
```


(a) Use the API from `https://geo.fcc.gov/api/census/#!/area/get_area` to get the county FIPS of Yolo county and state FIPS for California. 
Hint: Davis long and lat are (38.5449, -121.7405)

```{r}
r  =("https://geo.fcc.gov/api/census/area?lat=38.5449&lon=-121.7405&format=json")

a <- fromJSON(r,simplifyDataFrame = TRUE)
a$results
```
```{r}
c <-GET("https://geo.fcc.gov/api/census/area",
        query=list(
          lat = 38.5449,
          lon = -121.7405
        ))

json <-content(c, as = "text")

fromJSON(json)$results
```



Next, You are going to use the API from https://www.census.gov/data/developers/data-sets.html


(Optional)
You could only make 500 queries per IP address per day, so you may want to request a key http://api.census.gov/data/key_signup.html (Just enter your name in "Organization"). If you request a key, do not put your API key in the solution as plaintext. Store it in `.Renviron` (you could use `usethis::edit_r_environ("project")` to open and edit that file). In the file, put
```
CENSUS_API_KEY="YOUR KEY"
```
Of course, do not commit `.Renviron` to git.


This is an example call to get the 2019 estimated population in USA
```{r, eval = FALSE}
r <- GET("https://api.census.gov/data/2019/pep/population",
         query = list(
           key = Sys.getenv("CENSUS_API_KEY"),
           get = "POP",
           `for` = "us"
         ))
json <- content(r, as = "text" )
fromJSON(json, simplifyMatrix = FALSE)
```

This is their API documentation. 
https://www.census.gov/data/developers/guidance/api-user-guide.html


(b) By using the API, find the 10th mostly populated state in 2019. 

Hint: you will need to change the `for` parameter.

```{r}
t  <- GET("https://api.census.gov/data/2018/pep/population",
         query = list(
           get = "GEONAME,POP",
           `for` = "state:*"
           
         ))

json <- content(t,as = "text")
b <-fromJSON(json,simplifyDataFrame = TRUE)
b<- data.frame(b )
b

b %>% rename("State Name" =X1, "Population" =X2, "FIPS" = X3) %>% slice(-1) %>% mutate(Population = as.numeric(as.character(Population))) %>% arrange(desc(Population)) %>% filter("Michigan" == `State Name`)

```



(c) By using the FIPS's in (a), find the estimated popluation in Yolo county.

Hint: you will need to change the `for` parameter and optionally use the `in` parameter.

```{r}
t  <- GET("https://api.census.gov/data/2018/pep/population",
         query = list(
           get = "GEONAME,POP",
           `for` = "county:113",
           `in` = "state:06"
          
         ))
json <- content(t,as = "text")
b <-fromJSON(json,simplifyDataFrame = TRUE)
b<- data.frame(b )
b
```
